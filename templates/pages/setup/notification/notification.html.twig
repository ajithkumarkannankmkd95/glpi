{#
 # ---------------------------------------------------------------------
 #
 # GLPI - Gestionnaire Libre de Parc Informatique
 #
 # http://glpi-project.org
 #
 # @copyright 2015-2023 Teclib' and contributors.
 # @copyright 2003-2014 by the INDEPNET Development Team.
 # @licence   https://www.gnu.org/licenses/gpl-3.0.html
 #
 # ---------------------------------------------------------------------
 #
 # LICENSE
 #
 # This file is part of GLPI.
 #
 # This program is free software: you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
 # the Free Software Foundation, either version 3 of the License, or
 # (at your option) any later version.
 #
 # This program is distributed in the hope that it will be useful,
 # but WITHOUT ANY WARRANTY; without even the implied warranty of
 # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 # GNU General Public License for more details.
 #
 # You should have received a copy of the GNU General Public License
 # along with this program.  If not, see <https://www.gnu.org/licenses/>.
 #
 # ---------------------------------------------------------------------
 #}

{% import 'components/form/fields_macros.html.twig' as fields %}

{{ include('components/form/header.html.twig') }}
{% set rand = random() %}
{% set field_options = {
    'full_width': true,
    'rand': rand
} %}

{% block form_fields %}
    <table class='tab_cadre_fixe'>
        <tr class='tab_bg_2'>
            <td>
                {{ fields.textField(
                    'name',
                    item.fields['name'],
                    __('Name'),
                    field_options
                ) }}
                {{ fields.dropdownYesNo(
                    'is_active',
                    item.fields['is_active'],
                    __('Active'),
                    field_options,
                ) }}
                {{ fields.dropdownYesNo(
                    'allow_response',
                    item.fields['allow_response'],
                    __('Allow response'),
                    field_options,
                ) }}
                {{ fields.dropdownItemTypes(
                    'itemtype',
                    item.fields['itemtype'],
                    __('Item type'),
                    field_options|merge({
                        'types': types,
                    }),
                ) }}
                {% do call('Ajax::updateItemOnSelectEvent', [
                    'dropdown_itemtype' ~ rand,
                    'show_events',
                    config('root_doc') ~ '/ajax/dropdownNotificationEvent.php',
                    {
                        'itemtype': '__VALUE__',
                     }
                ]) %}
                {% do call('Ajax::updateItemOnSelectEvent', [
                    'dropdown_itemtype' ~ rand,
                    'show_templates',
                    config('root_doc') ~ '/ajax/dropdownNotificationTemplate.php',
                    {
                        'itemtype': '__VALUE__',
                     }
                ]) %}

                {% set initial_field %}
                    {% do call('NotificationEvent::dropdownEvents', [
                        item.fields['itemtype'],
                        {
                            'value': item.fields['event']
                        }
                    ]) %}
                {% endset %}
                {{ fields.ajaxField(
                    'show_events',
                    initial_field,
                    __('Events'),
                    field_options
                ) }}

                {{ fields.dropdownArrayField(
                    "attach_documents",
                    item.fields['attach_documents'],
                    attach_documents_values,
                    __('Add documents'),
                    field_options
                ) }}
            </td>
            <td>
                {{ fields.textareaField(
                    'comment',
                    item.fields['comment'],
                    _n('Comment', 'Comments', get_plural_number()),
                    field_options
                ) }}
            </td>
        </tr>
    </table>
{% endblock %}

{{ include('components/form/buttons.html.twig') }}
